Компилятор gcc

После того как исходный код был на писан на языке C, программу можно скомпилировать в исполняемый файл.

    gcc -g execute source.c

Ключ `-g` указывается для добавления информации об отладке в файл. После запуска отладчика gdb можно будет посмотреть исходный код программы с помощью команды list

    gdb -q execute

Рассмотрим пример файла "Hello, world!" :

    int main()
    {
      int i;
      for (i=0; i<10; i++)
      {
        printf("Hello, world!\n");
      }
      return 0;
    }

Отладчик gdb отображает производит дизассемблирование и отражает код на языке Ассемблера в одной из двух архитектур: Intel или AT&T. Обе архитектуры отличаются синтаксисом и набором команд.

В синтаксисе Intel общий вид команды выглядит таким образом:

    операция <приемник>, <источник>

А в синтаксисе AT&T вид команды выглядит наоборот:

    операция <источник>, <приемник>

Выполним компиляцию и получим исполняемый файл

    gcc -g hello hello.c

Затем посмотрим как работает отладчик

    gdb -q hello

С помощью команды disassemble main можно получить такой вывод

    Dump of assembler code for function main:
       0x00000000000006b0 <+0>: push   rbp
       0x00000000000006b1 <+1>: mov    rbp,rsp
       0x00000000000006b4 <+4>: sub    rsp,0x10
       0x00000000000006b8 <+8>: mov    DWORD PTR [rbp-0x4],0x0
       0x00000000000006bf <+15>:  jmp    0x6d1 <main+33>
       0x00000000000006c1 <+17>:  lea    rdi,[rip+0x9c]        # 0x764
       0x00000000000006c8 <+24>:  call   0x560 <puts@plt>
       0x00000000000006cd <+29>:  add    DWORD PTR [rbp-0x4],0x1
       0x00000000000006d1 <+33>:  cmp    DWORD PTR [rbp-0x4],0x9
       0x00000000000006d5 <+37>:  jle    0x6c1 <main+17>
       0x00000000000006d7 <+39>:  mov    eax,0x0
       0x00000000000006dc <+44>:  leave  
       0x00000000000006dd <+45>:  ret    
    End of assembler dump.

Переключиться на Intel синтаксис поможет команда `set disassembly intel`, добавленная в конфиг `.gdbinit` в домашней директории. Тогда при старте gdb сможет прочитать нужную конфигурацию.

Слева мы видим адреса в памяти, по которым размещаются команды. Слева же видим команды языка Ассемблер, которые манипулируют ячейками памяти. Для более удобной отладки предусмотрены следующие команды:

`break 1` - можем установить точку останова на строку программы

`run` - запуск программы на выполнение

`info registers eax` - показать содержимое регистра

`x/o` - показать содержимое памяти в восьмеричном виде (или x шестнадцатеричном, u десятичном, t двоичном)

`nexti` - следующая инструкция процессора